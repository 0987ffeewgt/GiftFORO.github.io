<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Оплата TON</title>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    <style>
        body {
            background-color: #000;
            color: #fff;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            font-family: sans-serif;
        }
        .box {
            padding: 30px;
            background: #1a1a1a;
            border-radius: 20px;
            text-align: center;
            width: 300px;
        }
        #ton-connect {
            margin-top: 20px;
            display: flex;
            justify-content: center;
        }
        button {
            margin-top: 20px;
            padding: 10px 20px;
            background: #0088cc;
            border: none;
            border-radius: 10px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
            display: none; /* Скрыта по умолчанию */
        }
        button:hover { background: #0077b5; }
    </style>
</head>
<body>

    <div class="box">
        <h2>Оплата TON</h2>
        
        <div id="ton-connect"></div>

        <button id="send-ton" onclick="sendTransaction()">
            Оплатить
        </button>
        
        <p id="status" style="color: gray; font-size: 12px; margin-top: 15px;"></p>
    </div>

    <script>
        // 1. ИНИЦИАЛИЗАЦИЯ С ПОЛНОЙ ССЫЛКОЙ
        const tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
            // Вставляем АБСОЛЮТНУЮ ссылку на манифест, чтобы избежать ошибок путей
            manifestUrl: 'https://0987ffeewgt.github.io/GiftFORO.github.io/tonconnect-manifest.json',
            buttonRootId: 'ton-connect'
        });

        const payBtn = document.getElementById('send-ton');
        const status = document.getElementById('status');

        // 2. СЛУШАЕМ ПОДКЛЮЧЕНИЕ
        tonConnectUI.onStatusChange(wallet => {
            if (wallet) {
                payBtn.style.display = 'block'; // Показываем кнопку оплаты
                status.innerText = 'Кошелек подключен';
            } else {
                payBtn.style.display = 'none';
                status.innerText = 'Подключите кошелек';
            }
        });

        // 3. ОТПРАВКА ТРАНЗАКЦИИ
        async function sendTransaction() {
            const transaction = {
                validUntil: Math.floor(Date.now() / 1000) + 360,
                messages: [
                    {
                        address: "UQBilFNbDjQ-XLFMbrxVRrxrGgXd9U03lMuiGZk3jCa3ta0h", // Твой адрес
                        amount: "100000000", // 0.1 TON (1 TON = 1000000000)
                    }
                ]
            };

            try {
                await tonConnectUI.sendTransaction(transaction);
                alert('Транзакция отправлена!');
            } catch (e) {
                console.error(e);
                alert('Ошибка или отмена: ' + e);
            }
        }
    </script>
</body>
</html>
